DROP TABLE IF EXISTS users CASCADE;
DROP TABLE IF EXISTS category CASCADE;
DROP TABLE IF EXISTS transaction CASCADE;

CREATE TABLE users(
	id BIGINT GENERATED ALWAYS AS IDENTITY NOT NULL,
	name VARCHAR(100) NOT NULL,
	email VARCHAR(255) NOT NULL,
	password VARCHAR(255) NOT NULL,
	CONSTRAINT UK_User_email UNIQUE(email),
	CONSTRAINT PK_User PRIMARY KEY (id)
);

CREATE TABLE category(
	id BIGINT GENERATED ALWAYS AS IDENTITY NOT NULL,
	name VARCHAR(100) NOT NULL,
	CONSTRAINT PK_Category_name UNIQUE (name),
	CONSTRAINT PK_Category PRIMARY KEY (id)
);

CREATE TABLE transaction(
	id BIGINT GENERATED ALWAYS AS IDENTITY NOT NULL,
	user_id BIGINT NOT NULL,
	amount NUMERIC(12, 2) NOT NULL,
	type VARCHAR(10) NOT NULL,
	category_id BIGINT NOT NULL,
	description VARCHAR(255),
	date DATE NOT NULL,
	CONSTRAINT CK_Transaction_type CHECK (type IN ('INCOME', 'EXPENSE')),
	CONSTRAINT FK_Transaction_Users FOREIGN KEY (user_id) REFERENCES users(id),
	CONSTRAINT FK_Transaction_Category FOREIGN KEY (category_id) REFERENCES category(id),
	CONSTRAINT PK_Transaction PRIMARY KEY (id)
);
